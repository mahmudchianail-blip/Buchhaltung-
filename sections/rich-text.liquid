{%- comment -%}
Optispar – Loader + Hero (Shopify-safe, ohne React), kompakt
- Weißer Hintergrund, nur „Optispar“ animiert (Gradient + Drift)
- Start-Loader mit Buchstaben
- Typing-Text unter der Headline
- Größen kleiner/kompakter
{%- endcomment -%}

<style>
  /* Loader */
  @keyframes form-from-stardust {
    0% { opacity:0; transform: scale(1.5) translateY(-20px); filter: blur(10px) brightness(2); }
    50% { opacity:.8; filter: blur(2px) brightness(1.5); }
    100%{ opacity:1; transform: scale(1) translateY(0); filter: blur(0) brightness(1); }
  }
  @keyframes subtle-glow {
    0%,100%{ text-shadow:0 0 8px rgba(255,255,255,.2), 0 0 20px rgba(192,132,252,.3);}
    50%    { text-shadow:0 0 12px rgba(255,255,255,.3), 0 0 30px rgba(192,132,252,.5);}
  }
  @keyframes fade-out { from{opacity:1} to{opacity:0} }

  /* Hero reveal */
  @keyframes fade-in-up-scale {
    0%{opacity:0; transform: translateY(20px) scale(.9);}
    100%{opacity:1; transform: translateY(0) scale(1);}
  }
  @keyframes settle-in-place {
    0%{opacity:0; transform: translateY(-30px) scale(1.15); filter: blur(8px);}
    100%{opacity:1; transform: translateY(0) scale(1); filter: blur(0);}
  }

  /* Nur „Optispar“ animieren */
  .opti-brand {
    display:inline-block;
    background: linear-gradient(90deg,#00E08F,#0EA5E9,#7C3AED,#0EA5E9);
    -webkit-background-clip:text; background-clip:text; color:transparent;
    background-size:300% 100%;
    animation: opti-gradient 6s ease-in-out infinite, opti-drift 7.5s ease-in-out infinite;
  }
  @keyframes opti-gradient {
    0%{background-position:0% 50%} 50%{background-position:100% 50%} 100%{background-position:0% 50%}
  }
  @keyframes opti-drift {
    0%{transform:translate(0,0) scale(1)}
    20%{transform:translate(1px,-2px) scale(1.005)}
    40%{transform:translate(2px,1px) scale(1.01)}
    60%{transform:translate(-1px,-1px) scale(1.007)}
    80%{transform:translate(-2px,2px) scale(1.003)}
    100%{transform:translate(0,0) scale(1)}
  }

  /* Typing cursor */
  @keyframes blink { 50%{opacity:0} }
  .opti-cursor { animation: blink 1s step-start infinite; }

  /* Layout (kompakt) */
  .opti-hero { min-height: 72vh; display:flex; align-items:center; justify-content:center; text-align:center; padding: 0 1.25rem; }
  .opti-heading-1 { font-size: clamp(28px, 3.2vw, 40px); font-weight: 700; color: #1f2937; margin: 0; }
  .opti-heading-2 { font-size: clamp(40px, 5vw, 64px); font-weight: 800; margin: .4rem 0 0.75rem; }
  .opti-subtyping { height: 2.2rem; font-size: clamp(18px, 2.6vw, 24px); font-weight: 300; color:#4b5563; }
  .opti-text { margin: .75rem auto 0; max-width: 48rem; font-size: clamp(15px, 1.6vw, 18px); color:#6b7280; line-height: 1.65; }
  .opti-btnwrap { margin-top: 1.25rem; }
  .opti-btn {
    display:inline-block; padding: .6rem 1.75rem; border-radius:999px; color:#fff; font-weight:600;
    background-image: linear-gradient(90deg,#7c3aed,#db2777,#f97316);
    background-size: 200% auto; transition: transform .3s ease, filter .3s ease, box-shadow .3s ease, background-position .5s ease;
    box-shadow: 0 8px 20px rgba(124,58,237,.22);
  }
  .opti-btn:hover { transform: translateY(-2px) scale(1.03); background-position: right center; filter: brightness(1.05); box-shadow: 0 12px 28px rgba(124,58,237,.28); }

  /* Loader layout */
  .opti-loader { position:fixed; inset:0; z-index: 50; display:flex; align-items:center; justify-content:center; background:#fff; }
  .opti-loader-word { display:flex; gap:.05em; animation: subtle-glow 2s ease-in-out infinite; }
  .opti-loader-letter {
    opacity:0; font-weight:800; line-height:1;
    background: linear-gradient(90deg, #a78bfa, #ec4899, #fb923c);
    -webkit-background-clip:text; background-clip:text; color:transparent; background-size:200% auto;
    font-size: clamp(48px, 8vw, 100px);
  }

  /* Staging */
  .opti-stage [data-reveal]{ opacity:0; transform: translateY(16px); }
  .opti-ready [data-reveal]{ animation: fade-in-up-scale .6s cubic-bezier(.23,1,.32,1) forwards; }
  .opti-ready [data-reveal].delay-1 { animation-delay: .15s; }
  .opti-ready [data-reveal].delay-2 { animation-delay: .35s; }
  .opti-ready [data-reveal].delay-3 { animation-delay: .55s; }

  @media (prefers-reduced-motion: reduce) {
    .opti-brand, .opti-ready [data-reveal]{ animation: none !important; }
    .opti-loader{ display:none !important; }
  }
</style>

<div class="opti-stage" id="optispar-hero-root">
  <!-- Loader -->
  <div class="opti-loader" id="optiLoader" aria-live="polite" aria-label="Lade Optispar">
    <div class="opti-loader-word" id="optiLoaderWord"></div>
  </div>

<!-- Hero -->
<section class="opti-hero" id="optispar-hero-root">
  <div class="opti-hero__inner">
    <h1 class="opti-heading-1 d0" data-reveal>Willkommen bei</h1>
    <h2 class="opti-heading-2 d1" data-reveal><span class="opti-brand">Optispar</span></h2>

    <div class="opti-subtyping d2" data-reveal>
      <span id="optiTyping"></span><span class="opti-cursor">|</span>
    </div>

    <p class="opti-text d2" data-reveal>
      Ihr zuverlässiger Partner für sorgfältig ausgewählte Produkte, die Ihren Alltag erleichtern und bereichern.
    </p>

    <div class="opti-btnwrap d3" data-reveal>
      <a href="/collections/all" class="opti-btn">Jetzt Einkaufen</a>
    </div>
  </div>
</section>

<style>
/* compact, mobile-first */
.opti-hero{padding:24px 16px;text-align:center}
.opti-hero__inner{max-width:980px;margin:0 auto}
.opti-heading-1{margin:0;font-size:clamp(1.2rem,3.6vw,1.6rem)}
.opti-heading-2{margin:.2rem 0 0;line-height:1.1;font-size:clamp(2rem,7vw,3.2rem)}
.opti-brand{background:linear-gradient(135deg,#6d28d9,#ec4899);-webkit-background-clip:text;background-clip:text;color:transparent}
.opti-subtyping{min-height:1.4em;margin:.25rem 0 .5rem}
.opti-cursor{margin-left:.1em;animation:blink 1s steps(1) infinite}
@keyframes blink{50%{opacity:0}}
.opti-text{max-width:60ch;margin:8px auto 0;line-height:1.6;font-size:clamp(.95rem,3.4vw,1.05rem)}
.opti-btn{display:inline-block;margin-top:12px;padding:.9rem 1.4rem;border-radius:9999px;background:linear-gradient(135deg,#7c3aed,#22d3ee);color:#fff;font-weight:800;text-decoration:none;box-shadow:0 10px 22px rgba(0,0,0,.1);transition:transform .18s,box-shadow .18s,background-position .6s;background-size:200% 100%}
.opti-btn:hover{transform:translateY(-1px);background-position:100% 0;box-shadow:0 14px 28px rgba(0,0,0,.14)}
/* reveal-on-scroll with tiny delays */
[data-reveal]{opacity:0;transform:translateY(14px)}
.rev{animation:rev .55s cubic-bezier(.2,.65,.2,1) forwards}
.d1{animation-delay:.08s}.d2{animation-delay:.16s}.d3{animation-delay:.24s}
@keyframes rev{to{opacity:1;transform:none}}
/* desktop offsets (falls gewünscht) */
@media(min-width:990px){#optispar-hero-root{margin-top:-110px;margin-bottom:-120px}}
</style>

<script>
/* reveal-on-scroll (ultrakompakt) */
(()=>{const i=[...document.querySelectorAll('#optispar-hero-root [data-reveal]')];
if(!i.length) return;const o=new IntersectionObserver(e=>e.forEach(x=>{if(x.isIntersecting){x.target.classList.add('rev');o.unobserve(x.target)}}),{threshold:.2});i.forEach(n=>o.observe(n));})();

/* typing effect – klein & smooth */
(()=>{const el=document.getElementById('optiTyping');if(!el) return;
const words=['Smarte Deals','Schneller Versand','Top Support'];let i=0,j=0,del=false;
function tick(){const w=words[i];el.textContent=del?w.slice(0,--j):w.slice(0,++j);
if(!del&&j===w.length){del=true;setTimeout(tick,1000);return}
if(del&&j===0){del=false;i=(i+1)%words.length}
setTimeout(tick,del?45:75)}tick()})();
</script>

<script>
  (function(){
    var root = document.getElementById('optispar-hero-root');
    var loader = document.getElementById('optiLoader');
    var wordEl = document.getElementById('optiLoaderWord');

    /* ===== Loader: Buchstaben nacheinander ===== */
    var brand = 'Optispar';
    var LETTER_ANIM = 1000; // ms
    var STAGGER = 150;      // ms
    var HOLD = 800;         // ms

    // baue Buchstaben
    brand.split('').forEach(function(ch, i){
      var span = document.createElement('span');
      span.className = 'opti-loader-letter';
      span.textContent = ch;
      span.style.animation = 'form-from-stardust '+LETTER_ANIM+'ms cubic-bezier(0.16,1,0.3,1) '+(i*STAGGER)+'ms forwards';
      wordEl.appendChild(span);
    });

    var total = (brand.length * STAGGER) + LETTER_ANIM + HOLD;

    // Nach Gesamtzeit: Loader ausblenden, Content einblenden
    setTimeout(function(){
      loader.style.animation = 'fade-out .45s linear forwards';
      setTimeout(function(){
        loader.parentNode && loader.parentNode.removeChild(loader);
        root.classList.remove('opti-stage');
        root.classList.add('opti-ready');
      }, 480);
    }, Math.max(0, total-400));

    /* ===== Typing-Effekt ===== */
    var typingEl = document.getElementById('optiTyping');
    var phrases = ['Trendige Gadgets','Smarte Lösungen','Innovative Technik'];
    var i = 0, txt = '', del = false;
    var TYPE_SPEED = 100, DELETE_SPEED = 60, DELAY = 1600;

    function tick(){
      var cur = phrases[i % phrases.length];
      if(!del){
        txt = cur.slice(0, txt.length+1);
        typingEl.textContent = txt;
        if(txt.length === cur.length){ setTimeout(function(){ del = true; }, DELAY); }
      } else {
        txt = cur.slice(0, Math.max(0, txt.length-1));
        typingEl.textContent = txt;
        if(txt.length === 0){ del = false; i++; }
      }
      setTimeout(tick, del ? DELETE_SPEED : TYPE_SPEED);
    }
    // starte Tippen leicht verzögert nach Loader
    setTimeout(tick, total + 300);
  })();
</script>
